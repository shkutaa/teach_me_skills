function prepareIndex(){window.RESIZE_ETALON_LISIZE=194;window.DATA={list:{},list_items:{},list_cells:{},cell_dynamic:{}};jQuery(window).bind('resize',function(){indexPageResize();});indexPageResize();window.loaderImage=new Image();window.loaderImage.src='/img/mini2.gif';}
function getMenuInstance(showCallbackFunction,hideCallbackFunction){var lastUpdate=null;var lastShowParams=null
var lastDOMElement=null;function setMenuHideTimeOut(){var currentDate=new Date();var currentTimeMark=(currentDate.getHours()*60*60)+(currentDate.getMinutes()*60)+currentDate.getSeconds();lastUpdate=currentTimeMark;window.setTimeout(function(DOMElement,categoryName){if(lastUpdate!==null&&lastUpdate==currentTimeMark&&lastShowParams!==null){if(jQuery.isFunction(hideCallbackFunction)){hideCallbackFunction(lastShowParams);}}},600);}
function clearHideTimeOut(){lastUpdate=null;}
return{show:function(showParams,jDOMElement){if(lastShowParams!==null){this.hide();}
if(jDOMElement!=undefined){lastDOMElement=jDOMElement.attr('id');}
lastShowParams=showParams;if(jQuery.isFunction(showCallbackFunction)){showCallbackFunction(showParams);}},hide:function(){if(lastShowParams!==null){lastDOMElement=null;clearHideTimeOut();if(jQuery.isFunction(hideCallbackFunction)){hideCallbackFunction(lastShowParams);}
lastShowParams=null;}},update:function(jDOMElement){if((lastDOMElement==null||jDOMElement==null)||lastDOMElement==jDOMElement.attr('id')){clearHideTimeOut();}},unactivate:function(){setMenuHideTimeOut();}}}
function showGoodsSaleBlock(DOMElement,actionMode){idGoods=parseInt(jQuery(DOMElement).attr('id').split('_').pop(),10);if(!isNaN(idGoods)&&idGoods>0){actionMode=jQuery.trim(actionMode.toLowerCase());switch(actionMode){case'show':jQuery('li[id*=goods_block_][class*="li-hover"]').removeClass('li-hover');jQuery(DOMElement).addClass('li-hover');break;case'hide':jQuery(DOMElement).removeClass('li-hover');break;default:break;}}}
function setGoodsInUserBox(DOMElement,idGoods){alert('Товар "'+idGoods+'" положен в корзину :)!')}
function changeCatalogMenuLockMode(DOMElement,categoryName,lockMode){lockMode=jQuery.trim(lockMode);switch(lockMode){case'lock':CatalogMenu.hide();jQuery('div#dinamic_menu_'+categoryName).hide();jQuery('div#staticmenu_header_'+categoryName).show();jQuery('div#category_goods_container_'+categoryName).removeClass('mpgs-nopin');resizeOneBlock(jQuery('div#category_goods_container_'+categoryName));jQuery.post('/goods/ajax/change_catalog_menu_state.php',{CATEGORY_NAME:categoryName,CATALOG_MODE:lockMode});break;case'unlock':jQuery('div#staticmenu_header_'+categoryName).hide();jQuery('div#dinamic_menu_'+categoryName).show();jQuery('div#category_goods_container_'+categoryName).addClass('mpgs-nopin');jQuery('ul#goods_block_'+categoryName).addClass('h-mpgs-items-1');resizeOneBlock(jQuery('div#category_goods_container_'+categoryName));jQuery.post('/goods/ajax/change_catalog_menu_state.php',{CATEGORY_NAME:categoryName,CATALOG_MODE:lockMode});break;default:break;}
return false;}
var CatalogMenu=new getMenuInstance(function(callbackParams){if(callbackParams!==undefined&&callbackParams.catalogName!=undefined&&callbackParams.DOMElement!=undefined){jQuery(callbackParams.DOMElement).addClass('b-mpgs-cat__hover').addClass("catalog_menu_hide").removeClass('catalog_menu_show').parent().addClass('mpgs-header-hover');}},function(callbackParams){if(callbackParams!==undefined&&callbackParams.catalogName!=undefined&&callbackParams.DOMElement!=undefined){jQuery(callbackParams.DOMElement).removeClass('b-mpgs-cat__hover').addClass("catalog_menu_show").removeClass('catalog_menu_hide').parent().removeClass('mpgs-header-hover');}});var CatalogLeftMenu=new getMenuInstance(function(callbackParams){if(callbackParams!==undefined&&callbackParams.DOMElement!=undefined){jQuery('li[id*="catalog_menu_item_"]').removeClass('cats-li-hover').find('ul').hide();jQuery(callbackParams.DOMElement).addClass('cats-li-hover').find('ul').show();}},function(callbackParams){if(callbackParams!==undefined&&callbackParams.DOMElement!=undefined){jQuery('li[id*="catalog_menu_item_"]').removeClass('cats-li-hover').find('ul').hide();jQuery(callbackParams.DOMElement).removeClass('cats-li-hover').find('ul').hide();}});function doMenuAction(DOMElement,categoryName){if(jQuery(DOMElement).is('.catalog_menu_show')){CatalogMenu.show({catalogName:categoryName,DOMElement:DOMElement},DOMElement);}else if(jQuery(DOMElement).is('.catalog_menu_hide')){CatalogMenu.hide({catalogName:categoryName,DOMElement:DOMElement},DOMElement);}
return false;}
function doCatalogMenuAction(DOMElement,menuActionType){menuActionType=jQuery.trim(menuActionType);switch(menuActionType){case'mouseover':CatalogLeftMenu.show({DOMElement:DOMElement});break;case'mouseout':CatalogLeftMenu.unactivate();break;default:break;}
return false;}
function indexPageResize(){if(jQuery('.bday13').length){jQuery('.bday13').hide();}
function checkBlocks(DOMContainerListElement,DOMElementType){DOMElementType=jQuery.trim(DOMElementType);var jDOMContainerListElement=jQuery(DOMContainerListElement);var jDOMFirstListElement=jQuery('ul[id^="goods_block_"][id$="_1"]',jQuery('div.mpgs-col-2',jDOMContainerListElement));var listActualWidth=jDOMFirstListElement.innerWidth();var listAllowBlocItemsCount=Math.floor(listActualWidth/window.RESIZE_ETALON_LISIZE);var listAllowBlocItemsMaxIndex=listAllowBlocItemsCount-1;var checkBlockItemsMinIndex=DOMElementType=='special'||DOMElementType=='static'?3:4;var checkBlockItemsMaxIndex=DOMElementType=='special'||DOMElementType=='static'?5:6;if(listAllowBlocItemsCount>0){var listFreeSpaceWidth=(listActualWidth)-(listAllowBlocItemsCount*window.RESIZE_ETALON_LISIZE);var listIncrementWidth=listFreeSpaceWidth>0?Math.floor(listFreeSpaceWidth/listAllowBlocItemsCount):0;if(window.DATA.list_items[DOMElementType]==undefined){window.DATA.list_items[DOMElementType]=DOMElementType=='special'?jQuery('li.lispecial'):DOMElementType=='static'?jQuery('li.listatic'):jQuery('li.ligoods');}
var classString=new Array();for(var zx=0;zx<=listAllowBlocItemsCount-1;zx++){classString.push('.li_'+zx);}
if(classString.length>0){classString=classString.join(',');if(window.DATA.list_cells[DOMElementType+classString]==undefined){window.DATA.list_cells[DOMElementType+classString]=window.DATA.list_items[DOMElementType].filter(classString);}
window.DATA.list_cells[DOMElementType+classString].show();}
var classString=new Array();for(var zx=listAllowBlocItemsMaxIndex+1;zx<=checkBlockItemsMaxIndex;zx++){classString.push('.li_'+zx);}
if(classString.length>0){classString=classString.join(',');if(window.DATA.list_cells[DOMElementType+classString]==undefined){window.DATA.list_cells[DOMElementType+classString]=window.DATA.list_items[DOMElementType].filter(classString);}
window.DATA.list_cells[DOMElementType+classString].hide();}
var newWidth=(window.RESIZE_ETALON_LISIZE+listIncrementWidth);if(DOMElementType=='static')newWidth=newWidth-Math.floor(20/listAllowBlocItemsCount);var hiddenCounter=0;jQuery.each(window.DATA.list_items[DOMElementType],function(k,el){if(jQuery(el).css('display')=='none'){hiddenCounter=hiddenCounter+1;}else{var width=newWidth-1;if((k+1-hiddenCounter)%listAllowBlocItemsCount==0){if(DOMElementType=='static'){jQuery(el).css('width',(width-1)+'px');}
else{jQuery(el).css('width',width+'px');}}else{jQuery(el).css('width',width+'px');}}});}}
if(window.DATA.list['special_block']==undefined){window.DATA.list['special_block']=jQuery('div#special_category_goods_container');}
checkBlocks(window.DATA.list['special_block'],'special');if(window.DATA.list['static_block']==undefined){window.DATA.list['static_block']=jQuery('div[id^="category_goods_container"]').filter(':not(.mpgs-nopin)').first();}
checkBlocks(window.DATA.list['static_block'],'static');if(window.DATA.list['other_block']==undefined){window.DATA.list['other_block']=jQuery('div[id^="category_goods_container"]').filter('.mpgs-nopin').first();}
checkBlocks(window.DATA.list['other_block'],'other');if(jQuery('.bday13').length){var liArray=jQuery('.lispecial');if(liArray.length){jQuery('.bday13').width(jQuery(liArray[0]).width()*2);jQuery('.bday13').show();var specialLiCollection=jQuery('.lispecial');var counter=0;for(var i=(specialLiCollection.length-1);i>=0;i--){if(counter==2){break;}
if(jQuery(specialLiCollection[i]).is(":visible")){++counter;jQuery(specialLiCollection[i]).hide();}}}}}
function resizeOneBlock(jDOMContainerElement){var listAllowBlocItemsCount=0;var listAllowBlocItemsMaxIndex=0;var listFreeSpaceWidth=0;var listIncrementWidth=0;jQuery('ul[id^="goods_block_'+'"]',jDOMContainerElement).each(function(index,DOMListElement){jDOMListElement=jQuery(DOMListElement);if(index==0){listAllowBlocItemsCount=Math.floor(jDOMListElement.innerWidth()/window.RESIZE_ETALON_LISIZE);listAllowBlocItemsMaxIndex=listAllowBlocItemsCount-1;listFreeSpaceWidth=jDOMListElement.innerWidth()-(listAllowBlocItemsCount*window.RESIZE_ETALON_LISIZE);listIncrementWidth=listFreeSpaceWidth>0?Math.floor(listFreeSpaceWidth/listAllowBlocItemsCount):0;}
var classString=new Array();for(var zx=3;zx<=listAllowBlocItemsMaxIndex;zx++){classString.push('.li_'+zx);}
if(classString.length>0){jQuery(classString.join(','),jDOMListElement).show();}
delete(classString);var classString=new Array();for(var zx=listAllowBlocItemsMaxIndex+1;zx<=6;zx++){classString.push('.li_'+zx);}
if(classString.length>0){jQuery(classString.join(','),jDOMListElement).hide();}
delete(classString);changeStyle(jQuery('li',jDOMListElement));jQuery('li',jDOMListElement).css('width',(window.RESIZE_ETALON_LISIZE+listIncrementWidth)+'px');});if(window.DATA&&window.DATA.list_items){delete(window.DATA.list_items);window.DATA.list_items={};}
if(window.DATA&&window.DATA.list_cells){delete(window.DATA.list_cells);window.DATA.list_cells={};}
function changeStyle(jDOMLiElement){if(jDOMLiElement.is('.ligoods')){jDOMLiElement.removeClass('ligoods').addClass('listatic').css('left','0px');}else if(jDOMLiElement.is('.listatic')){jDOMLiElement.removeClass('listatic').addClass('ligoods').css('left','-1px');}}}
jQuery(function(){function setPersonalData(_list){jQuery('#personal-block').find('.b-mpgs-filters__item--active').removeClass('b-mpgs-filters__item--active');jQuery('#personal-block').find('.b-mpgs-filters__item[data-list='+_list+']').addClass('b-mpgs-filters__item--active');jQuery('#personal-block').find('.goods-list').hide();jQuery('#personal-block').find('#list-'+_list).show();if(typeof(favScroll)!='undefined'){favScroll.refresh();}
if(typeof(waitScroll)!='undefined'){waitScroll.refresh();}
jQuery('#myoz-block').find('.b-mpgs__eselect-list__item_active').removeClass('b-mpgs__eselect-list__item_active');var _curitem=jQuery('#myoz-block').find('.b-mpgs__eselect-list__item[data-list='+_list+']').addClass('b-mpgs__eselect-list__item_active');html='<strong>'+_curitem.data('title')+'</strong>';if(parseInt(_curitem.data("count"))>0){html=html+' <small class="count">'+_curitem.data('count')+'</small>';}
jQuery('#personal-block').find('.pl-curitem').html(html);jQuery('#personal-block').find('.b-mpgs-header__dropfilter').eq(0).data('plugin_aim').hideNav();}
jQuery('#personal-block').find('.pl-link').each(function(){jQuery(this).on('click',function(e){e.preventDefault();var _this=jQuery(this);var _list=_this.data('list');setPersonalData(_list);});});});;