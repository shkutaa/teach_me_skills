jQuery(function($){var $expanded=$('.b-description__container');var $truncatedBlock=$expanded.find('#truncatedBlock');var $truncatedBlockComment=$('.truncated-block-comment');var $listExpander=$('.b-description__list-expand');var $anchor=$('.b-description__comment-link');var openExpanderClass='b-description__list-expand_expanded';var windowSize=$(window).width();var strokeHeight=69;function findLastElem(elem,link){var last=elem.children().last();if(last.is('p')||last.is('li')){return last.addClass('b-description__faded').append(link);}
if(last.is('ul')&&last.children().length===0){return last.addClass('b-description__faded').append(link);}
return findLastElem(last,link);}
$anchor.on('click',function(e){e.preventDefault();setTimeout(function(){var $target=$($anchor.attr('href'));$('html, body').animate({scrollTop:$target.offset().top},{duration:250});},100);});$listExpander.on('click',function(e){e.preventDefault();var $target=$(this);$target.toggleClass(openExpanderClass).siblings('ul').toggle();});$truncatedBlock.dotdotdot({ellipsis:'',wrap:'word',fallbackToLetter:true,watch:true,height:270,tolerance:0,callback:function(isTruncated){$truncatedBlock.removeClass('b-description__sub_hidden');if(isTruncated){var $link=jQuery('<a class="b-description__expanding-link" href="#">Полное описание</a>').on('click',function(e){e.preventDefault();$truncatedBlock.trigger('destroy');});findLastElem($truncatedBlock,$link);}}});if(windowSize<768){strokeHeight=133}
$truncatedBlockComment.each(function(index,item){$(item).dotdotdot({ellipsis:'',wrap:'word',fallbackToLetter:true,watch:true,height:strokeHeight,tolerance:0,callback:function(isTruncated){if(isTruncated){var $link=jQuery('<a class="b-product-control__scrolling-link" href="#">Читать отзыв</a>');$link.addClass('b-product-control__scrolling-link_truncate');$link.on('click',function(e){e.preventDefault();$(item).trigger('destroy');});}
$(this).find('p:last').addClass('b-product-control__faded').append($link);}});});});;